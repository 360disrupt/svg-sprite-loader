# svg-sprite-loader 2.0 overview

## How to migrate

tl;dr:
- Node.js >= 6 is required.
- `name` option was renamed to `symbolId`.
- `regExp`, `prefixize`, `angularBaseWorkaround` options was removed and will have no effect.
  Prefixize applies for symbol elements by default. Workaround for Angular enables automatically when `'angular' in window === true`.
- Runtime API has changed, but compatible mode available via `runtimeCompat: true`.

So in most cases following config should work:

```js
// webpack 1
module.exports = {
  module: {
    loaders: [
      {
        test: /\.svg$/,
        loader: 'svg-sprite-loader?runtimeCompat=true'
      }
    ]
  }
}

// webpack 2
module.exports = {
  module: {
    rules: [
      {
        test: /\.svg$/,
        loader: 'svg-sprite-loader',
        options: {
          runtimeCompat: true
        }
      }
    ]
  }
}
```

## New runtime API

Instead of symbol id runtime module now returns an object (class instance actually) which contains `id`, `viewBox` and `content` fields.
Reason: make runtime more flexible, also it was requested in #32.
 
```js
// old
import symbolId from './image.svg';
// symbolId === '#image'

const rendered = `
<svg>
  <use xlink:href="${symbolId}" />
</svg>`;


// new
import symbol from './image.svg';
// symbol === SpriteSymbol<id: string, viewBox: string, content: string>

const rendered = `
<svg viewBox="${symbol.viewBox}">
  <use xlink:href="#${symbol.id}" />
</svg>`;
```

If you need old behaviour, set `runtimeCompat` option to `true`.

## Features, improvements and bugfixes

### Auto configuring

Some magic now [happens](https://github.com/kisenka/svg-sprite-loader/blob/2.0/lib/configurator.js#L20) by default, viz:

- Used runtime module depends on webpack 'target' config option: [browser sprite module](https://github.com/kisenka/svg-sprite-loader/blob/2.0/runtime/browser-sprite.js) will be used for 'web' target, and [isomorphic sprite module](https://github.com/kisenka/svg-sprite-loader/blob/2.0/runtime/sprite.js) for all other targets.
- Loader turns in extract mode automatically if SVG image was imported from css/scss/html etc (see [EXTRACTABLE_MODULE_ISSUER_PATTERN config param](https://github.com/kisenka/svg-sprite-loader/blob/2.0/lib/config.js#L7)).
- Generated export format depends on webpack version, `module.exports = ...` for webpack 1, `export default ...` for webpack 2.

### Sprite generator

- Sprite/symbol generator was moved in separate project ([svg-baker](https://github.com/kisenka/svg-baker)) and fully reworked. It's incredible customizable now. Customization via plugin coming soon.

### Client runtime

- Sprite/symbol javascript runtime was moved in separate project ([svg-baker-runtime](https://github.com/kisenka/svg-baker/tree/master/packages/svg-baker-runtime)) and fully reworked.
- Added ability to specify custom runtime generator via `runtimeGenerator` option (check default [runtime generator](https://github.com/kisenka/svg-sprite-loader/blob/2.0/lib/runtime-generator.js) for example).
- Runtime symbol is an object now (class instance actually). It contains `id`, `viewBox` and `content` fields. See [SpriteSymbol class](https://github.com/kisenka/svg-baker/blob/edb3814a5ec2d11ef940955739d86d4af7a2474d/packages/svg-baker-runtime/src/symbol.js).
  - Fixes #32.
- Base URL fix in `style` attributes (via [svg-baker-runtime](https://github.com/kisenka/svg-baker/blob/18b2340c0da957204bd5ba4338cc01939048c8b4/packages/svg-baker-runtime/test/browser-utils.test.js#L77)).
  - Fixes #7.

### Server side rendering

- Server side rendering done right! See [example](https://github.com/kisenka/svg-sprite-loader/tree/2.0/examples/server-side-rendering).
- Fixes #19.

### Extract sprite/sprites as separate file/files

- Extract sprite as separate file done right! See [example](https://github.com/kisenka/svg-sprite-loader/tree/2.0/examples/extract-sprite).
- Ability to extract multiple separate sprites by webpack loader config (example will be soon).
- Ability to extract sprite for each chunk, like extract-text-webpack-plugin (example will be soon). Experimental feature, should be used with caution.
- Fixes #66, #73, #83.


